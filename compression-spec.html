<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>HTTP/2.0 Header Compression</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Overview"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Outline"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Header Encoding"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Encoding Components"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Header Table"/>
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Header Representation"/>
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Literal Representation"/>
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 Indexed Representation"/>
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Differential Coding"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Detailed Format"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Header Blocks"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Low-level representations"/>
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Integer representation"/>
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 String literal representation"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Indexed Header Representation"/>
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Literal Header Representation"/>
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 Literal Header without Indexing"/>
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 Literal Header with Incremental Indexing"/>
<link href="#rfc.section.4.4.3" rel="Chapter" title="4.4.3 Literal Header with Substitution Indexing"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Parameter Negotiation"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations"/>
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations"/>
<link href="#rfc.references" rel="Chapter" title="8 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Initial header names"/>
<link href="#rfc.appendix.A.1" rel="Chapter" title="A.1 Requests"/>
<link href="#rfc.appendix.A.2" rel="Chapter" title="A.2 Responses"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B Example"/>
<link href="#rfc.appendix.B.1" rel="Chapter" title="B.1 First header set"/>
<link href="#rfc.appendix.B.2" rel="Chapter" title="B.2 Second header set"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.4.1 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Peon, R. and H. Ruellan" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-httpbis-header-compression-01" />
  <meta name="dct.issued" scheme="ISO8601" content="2013-7-09" />
  <meta name="dct.abstract" content="This document describes a format adapted to efficiently represent HTTP headers in the context of HTTP/2.0.  " />
  <meta name="description" content="This document describes a format adapted to efficiently represent HTTP headers in the context of HTTP/2.0.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">HTTPbis Working Group</td>
  <td class="right">R. Peon</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Google, Inc</td>
</tr>
<tr>
  <td class="left">Intended status: Informational</td>
  <td class="right">H. Ruellan</td>
</tr>
<tr>
  <td class="left">Expires: January 10, 2014</td>
  <td class="right">Canon CRF</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">July 09, 2013</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">HTTP/2.0 Header Compression<br />
  <span class="filename">draft-ietf-httpbis-header-compression-01</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document describes a format adapted to efficiently represent HTTP headers in the context of HTTP/2.0.  </p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 10, 2014.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2013 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">Overview</a></li>
<li>2.1.   <a href="#rfc.section.2.1">Outline</a></li>
<li>3.   <a href="#rfc.section.3">Header Encoding</a></li>
<li>3.1.   <a href="#rfc.section.3.1">Encoding Components</a></li>
<li>3.2.   <a href="#rfc.section.3.2">Header Table</a></li>
<li>3.3.   <a href="#rfc.section.3.3">Header Representation</a></li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">Literal Representation</a></li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">Indexed Representation</a></li>
<li>3.4.   <a href="#rfc.section.3.4">Differential Coding</a></li>
<li>4.   <a href="#rfc.section.4">Detailed Format</a></li>
<li>4.1.   <a href="#rfc.section.4.1">Header Blocks</a></li>
<li>4.2.   <a href="#rfc.section.4.2">Low-level representations</a></li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">Integer representation</a></li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">String literal representation</a></li>
<li>4.3.   <a href="#rfc.section.4.3">Indexed Header Representation</a></li>
<li>4.4.   <a href="#rfc.section.4.4">Literal Header Representation</a></li>
<li>4.4.1.   <a href="#rfc.section.4.4.1">Literal Header without Indexing</a></li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">Literal Header with Incremental Indexing</a></li>
<li>4.4.3.   <a href="#rfc.section.4.4.3">Literal Header with Substitution Indexing</a></li>
<li>5.   <a href="#rfc.section.5">Parameter Negotiation</a></li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a></li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a></li>
<li>8.   <a href="#rfc.references">Informative References</a></li>
<li>Appendix A.   <a href="#rfc.appendix.A">Initial header names</a></li>
<li>A.1.   <a href="#rfc.appendix.A.1">Requests</a></li>
<li>A.2.   <a href="#rfc.appendix.A.2">Responses</a></li>
<li>Appendix B.   <a href="#rfc.appendix.B">Example</a></li>
<li>B.1.   <a href="#rfc.appendix.B.1">First header set</a></li>
<li>B.2.   <a href="#rfc.appendix.B.2">Second header set</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document describes a format adapted to efficiently represent HTTP headers in the context of HTTP/2.0.  </p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#overview" id="overview">Overview</a></h1>
<p id="rfc.section.2.p.1">In HTTP/1.X, HTTP headers, which are necessary for the functioning of the protocol, are transmitted with no transformations. Unfortunately, the amount of redundancy in both the keys and the values of these headers is astonishingly high, and is the cause of increased latency on lower bandwidth links. This indicates that an alternate encoding for headers would be beneficial to latency, and that is what is proposed here.  As shown by <a href="#SPDY">SPDY</a> <cite title="NONE">[SPDY]</cite>, Deflate compresses HTTP very effectively. However, the use of a compression scheme which allows for arbitrary matches against the previously encoded data (such as Deflate) exposes users to security issues.  In particular, the compression of sensitive data, together with other data controlled by an attacker, may lead to leakage of that sensitive data, even when the resultant bytes are transmitted over an encrypted channel.  Another consideration is that processing and memory costs of a compressor such as Deflate may also be too high for some classes of devices, for example when doing forward or reverse proxying.  </p>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> Outline</h1>
<p id="rfc.section.2.1.p.1">The HTTP header representation described in this document is based on indexing tables that store (name, value) pairs, called header tables in the remainder of this document.  This scheme is believed to be safe for all known attacks against the compression context today.  Header tables are incrementally updated during the whole HTTP/2.0 session.  Two independent header tables are used during a HTTP/2.0 session, one for HTTP request headers and one for HTTP response headers.  </p>
<p id="rfc.section.2.1.p.2">The encoder is responsible for deciding which headers to insert as (name, value) pairs in the header table.  The decoder then does exactly what the encoder prescribes, ending in a state that exactly matches the encoder's state.  This enables decoders to remain simple and understand a wide variety of encoders.  </p>
<p id="rfc.section.2.1.p.3">A header may be represented as a literal or as an index.  If represented as a literal, the representation specifies whether this header is used to update the indexing table.  The different representations are described in <a href="#header.representation">Section 3.3</a>.  </p>
<p id="rfc.section.2.1.p.4">A set of headers is coded as a difference from the previous set of headers.  </p>
<p id="rfc.section.2.1.p.5">An example illustrating the use these different mechanisms to represent headers is available in <a href="#example">Appendix B</a>.  </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#header.encoding" id="header.encoding">Header Encoding</a></h1>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#encoding.components" id="encoding.components">Encoding Components</a></h1>
<p id="rfc.section.3.1.p.1">The encoding and decoding of headers relies on a few components. First, a header table (see <a href="#header.table">Section 3.2</a>) is used to associate headers to index values. Second, a set of headers is encoded as a difference from the previous reference set of headers (see <a href="#differential.coding">Section 3.4</a>).  </p>
<p id="rfc.section.3.1.p.2">As messages are exchanged in two directions, from client to server and from server to client, there are two sets of components: one for each direction. All the headers sent in messages from the client to the server are encoded (and decoded) using one set of components. All the headers sent in messages from the server to the client (including headers contained in PUSH_PROMISE frame) are encoded using the other set of compotents.  </p>
<h1 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> <a href="#header.table" id="header.table">Header Table</a></h1>
<p id="rfc.section.3.2.p.1">A header table consists of an ordered list of (name, value) pairs. A pair is either inserted at the end of the table or replaces an existing pair depending on the chosen representation. A pair can be represented as an index which is its position in the table, starting with 0 for the first entry.  </p>
<p id="rfc.section.3.2.p.2">An input header name matches the header name of a (name, value) pair stored in the Header Table if they are equal using a character-based, <em>case sensitive</em> comparison.  An input header value matches the header value of a (name, value) pair stored in the Header Table if they are equal using a character-based, <em>case sensitive</em> comparison.  An input header (name, value) pair matches a pair in the Header Table if both the name and value are matching as per above.  </p>
<p id="rfc.section.3.2.p.3">Generally, the header table will not contain duplicate header (name, value) entries. However, implementations MUST be prepared to accept duplicates without signaling an error. If duplicates are added to the table, they MUST be treated as distinct entries with their own index positions.  </p>
<p id="rfc.section.3.2.p.4">The header table is progressively updated based on headers represented as literal (as defined in <a href="#literal">Section 3.3.1</a>).  Two update mechanisms are defined: </p>

<ul>
  <li>Incremental indexing: the represented header is inserted at the end of the header table as a (name, value) pair.  The inserted pair index is set to the next free index in the table: it is equal to the number of headers in the table before its insertion.  </li>
  <li>Substitution indexing: the represented header contains an index to an existing (name, value) pair. The existing pair value is replaced by the pair representing the new header.  </li>
</ul>

<p> Incremental and substitution indexing are optional.  If none of them is selected in a header representation, the header table is not updated.  In particular, no update happens on the header table when processing an indexed representation.  </p>
<p id="rfc.section.3.2.p.5">The header table size can be bounded so as to limit the memory requirements (see the SETTINGS_MAX_BUFFER_SIZE in <a href="#parameter.negotiation">Section 5</a>).  The header table size is defined as the sum of the size of each entry of the table. The size of an entry is the sum of the length in bytes (as defined in <a href="#string.literal.representation">Section 4.2.2</a>) of its name, of value's length in bytes and of 32 bytes (for accounting for the entry structure overhead). The header table size MUST NOT exceed this limit.  </p>
<p id="rfc.section.3.2.p.6">Before adding a new entry to the header table or changing an existing one, a check has to be performed to ensure that the change will not cause the table to grow in size beyond the SETTINGS_MAX_BUFFER_SIZE limit. If necessary, one or more items from the beginning of the table are removed until there is enough free space available to make the modification. Dropping an entry from the beginning of the table causes the index positions of the remaining entries in the table to be decremented by 1.  </p>
<p id="rfc.section.3.2.p.7">When using substitution indexing, it is possible that the existing item being replaced might be one of the items removed when performing the necessary size adjustment. In such cases, the substituted value being added to the header table is inserted at the beginning of the header table (at index position #0) and the index positions of the other remaining entries in the table are incremented by 1.  </p>
<p id="rfc.section.3.2.p.8">To optimize the representation of the headers exchanged at the beginning of an HTTP/2.0 session, the header table is initialized with common headers. Two lists of initial headers are provided in <a href="#initial.headers">Appendix A</a>.  One is for messages sent from a client to a server, the other is for messages sent from a server to a client.  </p>
<h1 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a> <a href="#header.representation" id="header.representation">Header Representation</a></h1>
<h1 id="rfc.section.3.3.1"><a href="#rfc.section.3.3.1">3.3.1.</a> <a href="#literal" id="literal">Literal Representation</a></h1>
<p id="rfc.section.3.3.1.p.1">The literal representation defines a new header.  A literal header is represented as: </p>

<ul>
  <li>A header name, with two possible representations: <ul><li>A literal string, as described in <a href="#string.literal.representation">Section 4.2.2</a>.  </li><li>A index in the header table referencing the name of the corresponding header. The index is represented as an integer, as described in <a href="#integer.representation">Section 4.2.1</a>.  </li></ul><p> </p></li>
  <li>The header value, represented as a literal string, as described in <a href="#string.literal.representation">Section 4.2.2</a>.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3.3.2"><a href="#rfc.section.3.3.2">3.3.2.</a> <a href="#indexed" id="indexed">Indexed Representation</a></h1>
<p id="rfc.section.3.3.2.p.1">The indexed representation defines a header as a match to a (name, value) pair in the header table.  An indexed header is  represented as: </p>

<ul>
  <li>An integer representing the index of the matching (name, value) pair, as described in <a href="#integer.representation">Section 4.2.1</a>.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3.4"><a href="#rfc.section.3.4">3.4.</a> <a href="#differential.coding" id="differential.coding">Differential Coding</a></h1>
<p id="rfc.section.3.4.p.1">A set of headers is encoded as a difference from the previous reference set of headers. The initial reference set of headers is the empty set.  </p>
<p id="rfc.section.3.4.p.2">An indexed representation toggles the presence of the header in the current set of headers. If the header corresponding to the indexed representation was not in the set, it is added to the set. If the header index was in the set, it is removed from it.  </p>
<p id="rfc.section.3.4.p.3">A literal representation adds a header to the current set of headers.  </p>
<p id="rfc.section.3.4.p.4">To ensure a correct decoding of a set of headers, the following steps or equivalent ones MUST be executed by the decoder.  </p>
<p id="rfc.section.3.4.p.5">First, upon starting the decoding of a new set of headers, the reference set of headers is interpreted into the working set of headers: for each header in the reference set, an entry is added to the working set, containing the header name, its value, and its current index in the header table.  </p>
<p id="rfc.section.3.4.p.6">Then, the header representations are processed in their order of occurrence in the frame.  </p>
<p id="rfc.section.3.4.p.7">For an indexed representation, the decoder checks whether the index is present in the working set. If true, the corresponding entry is removed from the working set. If several entries correspond to this encoded index, all these entries are removed from the working set. If the index is not present in the working set, it is used to retrieve the corresponding header from the header table, and a new entry is added to the working set representing this header.  </p>
<p id="rfc.section.3.4.p.8">For a literal representation, a new entry is added to the working set representing this header. If the literal representation specifies that the header is to be indexed, the header is added accordingly to the header table, and its index is included in the entry in the working set.  Otherwise, the entry in the working set contains an undefined index.  </p>
<p id="rfc.section.3.4.p.9">When all the header representations have been processed, the working set contains all the headers of the set of headers.  </p>
<p id="rfc.section.3.4.p.10">The new reference set of headers is computed by removing from the working set all the headers that are not present in the header table.  </p>
<p id="rfc.section.3.4.p.11">It should be noted that during the decoding of the header representations, the same index may be associated to different headers in the working set and in the header table.  </p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#detailed.format" id="detailed.format">Detailed Format</a></h1>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#header.blocks" id="header.blocks">Header Blocks</a></h1>
<p id="rfc.section.4.1.p.1">A header block consists of a set of header fields, which are name-value pairs. Each header field is encoded using one of the header representation.  </p>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#string.encoding" id="string.encoding">Low-level representations</a></h1>
<h1 id="rfc.section.4.2.1"><a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#integer.representation" id="integer.representation">Integer representation</a></h1>
<p id="rfc.section.4.2.1.p.1">Integers are used to represent name indexes, pair indexes or string lengths.  The integer representation keeps byte-alignment as much as possible as this allows various processing optimizations as well as efficient use of DEFLATE.  For that purpose, an integer representation always finishes at the end of a byte.  </p>
<p id="rfc.section.4.2.1.p.2">An integer is represented in two parts: a prefix that fills the current byte and an optional list of bytes that are used if the integer value does not fit in the prefix.  The number of bits of the prefix (called N) is a parameter of the integer representation.  </p>
<p id="rfc.section.4.2.1.p.3">The N-bit prefix allows filling the current byte.  If the value is small enough (strictly less than 2^N-1), it is encoded within the N-bit prefix.  Otherwise all the bits of the prefix are set to 1 and the value is encoded using an <a href="http://en.wikipedia.org/wiki/Variable-length_quantity">unsigned variable length integer</a> representation.  </p>
<p id="rfc.section.4.2.1.p.4">The algorithm to represent an integer I is as follows: </p>

<ol>
  <li>If I &lt; 2^N - 1, encode I on N bits</li>
  <li>Else, encode 2^N - 1 on N bits and do the following steps:</li>
  <li>
    <ol>
      <li>Set I to (I - (2^N - 1)) and Q to 1</li>
      <li>While Q &gt; 0</li>
      <li>
        <ol>
          <li>Compute Q and R, quotient and remainder of I divided by 2^7</li>
          <li>If Q is strictly greater than 0, write one 1 bit; otherwise, write one 0 bit</li>
          <li>Encode R on the next 7 bits</li>
          <li>I = Q</li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

<p> </p>
<h1 id="rfc.section.4.2.1.1"><a href="#rfc.section.4.2.1.1">4.2.1.1.</a> <a href="#integer.representation.example1" id="integer.representation.example1">Example 1: Encoding 10 using a 5-bit prefix</a></h1>
<p id="rfc.section.4.2.1.1.p.1">The value 10 is to be encoded with a 5-bit prefix.  </p>

<ul>
  <li>10 is less than 31 (= 2^5 - 1) and is represented using the 5-bit prefix.  </li>
</ul>

<p> </p>
<pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| X | X | X | 0 | 1 | 0 | 1 | 0 |   10 stored on 5 bits
+---+---+---+---+---+---+---+---+
</pre>
<p class="figure"></p>
<h1 id="rfc.section.4.2.1.2"><a href="#rfc.section.4.2.1.2">4.2.1.2.</a> <a href="#integer.representation.example2" id="integer.representation.example2">Example 2: Encoding 1337 using a 5-bit prefix</a></h1>
<p id="rfc.section.4.2.1.2.p.1">The value I=1337 is to be encoded with a 5-bit prefix.  </p>

<ul>
  <li>1337 is greater than 31 (= 2^5 - 1).</li>
  <li>
    <ul>
      <li>The 5-bit prefix is filled with its max value (31).</li>
    </ul>
  </li>
  <li>The value to represent on next bytes is I = 1337 - (2^5 - 1) = 1306.</li>
  <li>
    <ul>
      <li>1306 = 128*10 + 26, i.e. Q=10 and R=26.</li>
      <li>Q is greater than 1, bit 8 is set to 1.</li>
      <li>The remainder R=26 is encoded on next 7 bits.</li>
      <li>I is replaced by the quotient Q=10.</li>
    </ul>
  </li>
  <li>The value to represent on next bytes is I = 10.</li>
  <li>
    <ul>
      <li>10 = 128*0 + 10, i.e. Q=0 and R=10.</li>
      <li>Q is equal to 0, bit 16 is set to 0.</li>
      <li>The remainder R=10 is encoded on next 7 bits.</li>
      <li>I is replaced by the quotient Q=0.</li>
    </ul>
  </li>
  <li>The process ends.</li>
</ul>

<p> </p>
<pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| X | X | X | 1 | 1 | 1 | 1 | 1 |   Prefix = 31
| 1 | 0 | 0 | 1 | 1 | 0 | 1 | 0 |   Q&gt;=1, R=26
| 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 |   Q=0 , R=10
+---+---+---+---+---+---+---+---+
</pre>
<p class="figure"></p>
<h1 id="rfc.section.4.2.2"><a href="#rfc.section.4.2.2">4.2.2.</a> <a href="#string.literal.representation" id="string.literal.representation">String literal representation</a></h1>
<p id="rfc.section.4.2.2.p.1">Literal strings can represent header names or header values.  They are encoded in two parts: </p>

<ol>
  <li>The string length, defined as the number of bytes needed to store its UTF-8 representation, is represented as an integer with a zero bits prefix.  If the string length is strictly less than 128, it is represented as one byte.  </li>
  <li>The string value represented as a list of UTF-8 characters.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> Indexed Header Representation</h1>
<pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 1 |        Index (7+)         |
+---+---------------------------+
</pre>
<p class="figure">Indexed Header</p>
<p id="rfc.section.4.3.p.1">This representation starts with the '1' 1-bit pattern, followed by the index of the matching pair, represented as an integer with a 7-bit prefix.  </p>
<h1 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4.</a> Literal Header Representation</h1>
<h1 id="rfc.section.4.4.1"><a href="#rfc.section.4.4.1">4.4.1.</a> Literal Header without Indexing</h1>
<pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 1 |    Index (5+)     |
+---+---+---+-------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre>
<p class="figure">Literal Header without Indexing - Indexed Name</p>
<pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 1 |         0         |
+---+---+---+-------------------+
|       Name Length (8+)        |
+-------------------------------+
|  Name String (Length octets)  |
+-------------------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre>
<p class="figure">Literal Header without Indexing - New Name</p>
<p id="rfc.section.4.4.1.p.1">This representation, which does not involve updating the header table, starts with the '011' 3-bit pattern.  </p>
<p id="rfc.section.4.4.1.p.2">If the header name matches the header name of a (name, value) pair stored in the Header Table, the index of the pair increased by one (index + 1) is represented as an integer with a 5-bit prefix.  Note that if the index is strictly below 31, one byte is used.  </p>
<p id="rfc.section.4.4.1.p.3">If the header name does not match a header name entry, the value 0 is represented on 5 bits followed by the header name, represented as a literal string.  </p>
<p id="rfc.section.4.4.1.p.4">Header name representation is followed by the header value represented as a literal string as described in <a href="#string.literal.representation">Section 4.2.2</a>.  </p>
<h1 id="rfc.section.4.4.2"><a href="#rfc.section.4.4.2">4.4.2.</a> Literal Header with Incremental Indexing</h1>
<pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 0 |    Index (5+)     |
+---+---+---+-------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre>
<p class="figure">Literal Header with Incremental Indexing -                         Indexed Name</p>
<pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 0 |         0         |
+---+---+---+-------------------+
|       Name Length (8+)        |
+-------------------------------+
|  Name String (Length octets)  |
+-------------------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre>
<p class="figure">Literal Header with Incremental Indexing -                         New Name</p>
<p id="rfc.section.4.4.2.p.1">This representation starts with the '010' 3-bit pattern.  </p>
<p id="rfc.section.4.4.2.p.2">If the header name matches the header name of a (name, value) pair stored in the Header Table, the index of the pair increased by one (index + 1) is represented as an integer with a 5-bit prefix.  Note that if the index is strictly below 31, one byte is used.  </p>
<p id="rfc.section.4.4.2.p.3">If the header name does not match a header name entry, the value 0 is represented on 5 bits followed by the header name, represented as a literal string.  </p>
<p id="rfc.section.4.4.2.p.4">Header name representation is followed by the header value represented as a literal string as described in <a href="#string.literal.representation">Section 4.2.2</a>.  </p>
<h1 id="rfc.section.4.4.3"><a href="#rfc.section.4.4.3">4.4.3.</a> Literal Header with Substitution Indexing</h1>
<pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 |      Index (6+)       |
+---+---+-----------------------+
|    Substituted Index (8+)     |
+-------------------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre>
<p class="figure">Literal Header with Substitution Indexing -                         Indexed Name</p>
<pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 |           0           |
+---+---+-----------------------+
|       Name Length (8+)        |
+-------------------------------+
|  Name String (Length octets)  |
+-------------------------------+
|    Substituted Index (8+)     |
+-------------------------------+
|       Value Length (8+)       |
+-------------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre>
<p class="figure">Literal Header with Substitution Indexing -                         New Name</p>
<p id="rfc.section.4.4.3.p.1">This representation starts with the '00' 2-bit pattern.  </p>
<p id="rfc.section.4.4.3.p.2">If the header name matches the header name of a (name, value) pair stored in the Header Table, the index of the pair increased by one (index + 1) is represented as an integer with a 6-bit prefix.  Note that if the index is strictly below 62, one byte is used.  </p>
<p id="rfc.section.4.4.3.p.3">If the header name does not match a header name entry, the value 0 is represented on 6 bits followed by the header name, represented as a literal string.  </p>
<p id="rfc.section.4.4.3.p.4">The index of the substituted (name, value) pair is inserted after the header name representation as a 0-bit prefix integer.  </p>
<p id="rfc.section.4.4.3.p.5">The index of the substituted pair MUST correspond to a position in the header table containing a non-void entry. An index for the substituted pair that corresponds to empty position in the header table MUST be treated as an error.  </p>
<p id="rfc.section.4.4.3.p.6">This index is followed by the header value represented as a literal string as described in <a href="#string.literal.representation">Section 4.2.2</a>.  </p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#parameter.negotiation" id="parameter.negotiation">Parameter Negotiation</a></h1>
<p id="rfc.section.5.p.1">A few parameters can be used to accomodate client and server processing and memory requirements.  </p>

<dl>
  <dt>SETTINGS_MAX_BUFFER_SIZE:</dt>
  <dd style="margin-left: 8">Allows the sender to inform the remote endpoint of the maximum size it accepts for the header table.  <br/> The default value is 4096 bytes.  <br/> <br/> When the remote endpoint receives a SETTINGS frame containing a SETTINGS_MAX_BUFFER_SIZE setting with a value smaller than the one currently in use, it MUST send as soon as possible a HEADER frame with a stream identifier of 0x0 containing a value smaller than or equal to the received setting value.  <br/> <br/> A HEADER frame with a stream identifier of 0x0 indicates that the sender has reduced the maximum size of the header table. The new maximum size of the header table is encoded on 32-bit. The decoder MUST reduce its own header table by dropping entries from it until the size of the header table is lower than or equal to the transmitted maximum size.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#Security" id="Security">Security Considerations</a></h1>
<p id="rfc.section.6.p.1">TODO?</p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#IANA" id="IANA">IANA Considerations</a></h1>
<p id="rfc.section.7.p.1">This memo includes no request to IANA.</p>
<h1 id="rfc.references"><a href="#rfc.references">8.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="SPDY">[SPDY]</b>
      </td>
      <td class="top"><a title="Twist">Belshe, M.</a> and <a title="Google">R. Peon</a>, "<a>SPDY Protocol</a>", February 2012.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#initial.headers" id="initial.headers">Initial header names</a></h1>
<p>
  <br/>
</p>
<h1 id="rfc.appendix.A.1"><a href="#rfc.appendix.A.1">A.1.</a> Requests</h1>
<p id="rfc.section.A.1.p.1">The following table lists the pre-defined headers that make-up the initial header table user to represent requests sent from a client to a server.  </p>
<div id="rfc.table.1"/>
<div id="initial.headers.request"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <thead>
    <tr>
      <th class="left">Index</th>
      <th class="left">Header Name</th>
      <th class="left">Header Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">0</td>
      <td class="left">:scheme</td>
      <td class="left">http</td>
    </tr>
    <tr>
      <td class="left">1</td>
      <td class="left">:scheme</td>
      <td class="left">https</td>
    </tr>
    <tr>
      <td class="left">2</td>
      <td class="left">:host</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">3</td>
      <td class="left">:path</td>
      <td class="left">/</td>
    </tr>
    <tr>
      <td class="left">4</td>
      <td class="left">:method</td>
      <td class="left">GET</td>
    </tr>
    <tr>
      <td class="left">5</td>
      <td class="left">accept</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">6</td>
      <td class="left">accept-charset</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">7</td>
      <td class="left">accept-encoding</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">8</td>
      <td class="left">accept-language</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">9</td>
      <td class="left">cookie</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">10</td>
      <td class="left">if-modified-since</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">11</td>
      <td class="left">keep-alive</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">12</td>
      <td class="left">user-agent</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">13</td>
      <td class="left">proxy-connection</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">14</td>
      <td class="left">referer</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">15</td>
      <td class="left">accept-datetime</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">16</td>
      <td class="left">authorization</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">17</td>
      <td class="left">allow</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">18</td>
      <td class="left">cache-control</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">19</td>
      <td class="left">connection</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">20</td>
      <td class="left">content-length</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">21</td>
      <td class="left">content-md5</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">22</td>
      <td class="left">content-type</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">23</td>
      <td class="left">date</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">24</td>
      <td class="left">expect</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">25</td>
      <td class="left">from</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">26</td>
      <td class="left">if-match</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">27</td>
      <td class="left">if-none-match</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">28</td>
      <td class="left">if-range</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">29</td>
      <td class="left">if-unmodified-since</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">30</td>
      <td class="left">max-forwards</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">31</td>
      <td class="left">pragma</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">32</td>
      <td class="left">proxy-authorization</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">33</td>
      <td class="left">range</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">34</td>
      <td class="left">te</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">35</td>
      <td class="left">upgrade</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">36</td>
      <td class="left">via</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">37</td>
      <td class="left">warning</td>
      <td class="left"/>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A.2"><a href="#rfc.appendix.A.2">A.2.</a> Responses</h1>
<p id="rfc.section.A.2.p.1">The following table lists the pre-defined headers that make-up the initial header table used to represent responses sent from a server to a client. The same header table is also used to represent request headers sent from a server to a client in a PUSH_PROMISE frame.  </p>
<div id="rfc.table.2"/>
<div id="initial.headers.response"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <thead>
    <tr>
      <th class="left">Index</th>
      <th class="left">Header Name</th>
      <th class="left">Header Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">0</td>
      <td class="left">:status</td>
      <td class="left">200</td>
    </tr>
    <tr>
      <td class="left">1</td>
      <td class="left">age</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">2</td>
      <td class="left">cache-control</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">3</td>
      <td class="left">content-length</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">4</td>
      <td class="left">content-type</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">5</td>
      <td class="left">date</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">6</td>
      <td class="left">etag</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">7</td>
      <td class="left">expires</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">8</td>
      <td class="left">last-modified</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">9</td>
      <td class="left">server</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">10</td>
      <td class="left">set-cookie</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">11</td>
      <td class="left">vary</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">12</td>
      <td class="left">via</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">13</td>
      <td class="left">access-control-allow-origin</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">14</td>
      <td class="left">accept-ranges</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">15</td>
      <td class="left">allow</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">16</td>
      <td class="left">connection</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">17</td>
      <td class="left">content-disposition</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">18</td>
      <td class="left">content-encoding</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">19</td>
      <td class="left">content-language</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">20</td>
      <td class="left">content-location</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">21</td>
      <td class="left">content-md5</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">22</td>
      <td class="left">content-range</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">23</td>
      <td class="left">link</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">24</td>
      <td class="left">location</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">25</td>
      <td class="left">p3p</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">26</td>
      <td class="left">pragma</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">27</td>
      <td class="left">proxy-authenticate</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">28</td>
      <td class="left">refresh</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">29</td>
      <td class="left">retry-after</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">30</td>
      <td class="left">strict-transport-security</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">31</td>
      <td class="left">trailer</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">32</td>
      <td class="left">transfer-encoding</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">33</td>
      <td class="left">warning</td>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">34</td>
      <td class="left">www-authenticate</td>
      <td class="left"/>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> <a href="#example" id="example">Example</a></h1>
<p id="rfc.section.B.p.1">Here is an example that illustrates different representations and how tables are updated.  </p>
<h1 id="rfc.appendix.B.1"><a href="#rfc.appendix.B.1">B.1.</a> First header set</h1>
<pre>
:path: /my-example/index.html
user-agent: my-user-agent
x-my-header: first
</pre>
<p class="figure"></p>
<pre>
0x44      (literal header with incremental indexing, name index = 3)
0x16      (header value string length = 22)
/my-example/index.html
0x4D      (literal header with incremental indexing, name index = 12)
0x0D      (header value string length = 13)
my-user-agent
0x40      (literal header with incremental indexing, new name)
0x0B      (header name string length = 11)
x-my-header
0x05      (header value string length = 5)
first
</pre>
<p class="figure"></p>
<pre>
Header table
+---------+----------------+---------------------------+
|  Index  | Header Name    | Header Value              |
+---------+----------------+---------------------------+
|    0    | :scheme        | http                      |
+---------+----------------+---------------------------+
|    1    | :scheme        | https                     |
+---------+----------------+---------------------------+
|   ...   | ...            | ...                       |
+---------+----------------+---------------------------+
|   37    | warning        |                           |
+---------+----------------+---------------------------+
|   38    | :path          | /my-example/index.html    | added header
+---------+----------------+---------------------------+
|   39    | user-agent     | my-user-agent             | added header
+---------+----------------+---------------------------+
|   40    | x-my-header    | first                     | added header
+---------+----------------+---------------------------+
</pre>
<p class="figure"></p>
<pre>
Reference Set:
:path, /my-example/index.html
user-agent, my-user-agent
x-my-header, first
</pre>
<p class="figure"></p>
<p id="rfc.section.B.1.p.1">The first header set to represent is the following: </p>
<h1 id="rfc.appendix.B.2"><a href="#rfc.appendix.B.2">B.2.</a> Second header set</h1>
<pre>
:path: /my-example/resources/script.js
user-agent: my-user-agent
x-my-header: second
</pre>
<p class="figure"></p>
<pre>
0xa6       (indexed header, index = 38: removal from reference set)
0xa8       (indexed header, index = 40: removal from reference set)
0x04       (literal header, substitution indexing, name index = 3)
0x26       (replaced entry index = 38)
0x1f       (header value string length = 31)
/my-example/resources/script.js
0x5f 0x0a  (literal header, incremental indexing, name index = 40)
0x06       (header value string length = 6)
second
</pre>
<p class="figure"></p>
<pre>
Header table
+---------+----------------+---------------------------+
|  Index  | Header Name    | Header Value              |
+---------+----------------+---------------------------+
|    0    | :scheme        | http                      |
+---------+----------------+---------------------------+
|    1    | :scheme        | https                     |
+---------+----------------+---------------------------+
|   ...   | ...            | ...                       |
+---------+----------------+---------------------------+
|   37    | warning        |                           |
+---------+----------------+---------------------------+
|   38    | :path          | /my-example/resources/    | replaced
|         |                |     script.js             | header
+---------+----------------+---------------------------+
|   39    | user-agent     | my-user-agent             |
+---------+----------------+---------------------------+
|   40    | x-my-header    | first                     |
+---------+----------------+---------------------------+
|   41    | x-my-header    | second                    | added header
+---------+----------------+---------------------------+
</pre>
<p class="figure"></p>
<pre>
Reference Set:
:path, /my-example/resources/script.js
user-agent, my-user-agent
x-my-header, second
</pre>
<p class="figure"></p>
<p id="rfc.section.B.2.p.1">The second header set to represent is the following: </p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Roberto Peon</span> 
	  <span class="n hidden">
		<span class="family-name">Peon</span>
	  </span>
	</span>
	<span class="org vcardline">Google, Inc</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: fenix@google.com</span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hervé Ruellan</span> 
	  <span class="n hidden">
		<span class="family-name">Ruellan</span>
	  </span>
	</span>
	<span class="org vcardline">Canon CRF</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: herve.ruellan@crf.canon.fr</span>

  </address>
</div>

</body>
</html>